# Personal Finance Manager 💰

[![CI/CD Pipeline](https://github.com/postlog/finances/actions/workflows/ci.yml/badge.svg)](https://github.com/postlog/finances/actions)
[![Java](https://img.shields.io/badge/Java-17-orange.svg)](https://www.oracle.com/java/)
[![Maven](https://img.shields.io/badge/Maven-3.8+-blue.svg)](https://maven.apache.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

Backend-приложение для управления личными финансами с поддержкой множества пользователей, бюджетированием и аналитикой.

## 📋 Содержание

- [Возможности](#-возможности)
- [Архитектура](#-архитектура)
- [Требования](#-требования)
- [Установка и запуск](#-установка-и-запуск)
- [Использование](#-использование)
- [Примеры команд](#-примеры-команд)
- [Тестирование](#-тестирование)
- [Структура проекта](#-структура-проекта)
- [Технологии](#-технологии)

## ✨ Возможности

### Базовые функции
- ✅ **Авторизация пользователей** - регистрация и вход по логину и паролю
- ✅ **Управление доходами и расходами** - добавление транзакций с категориями
- ✅ **Бюджетирование** - установка лимитов на категории расходов
- ✅ **Статистика** - просмотр финансовой статистики по категориям
- ✅ **Уведомления** - предупреждения о превышении бюджета
- ✅ **Сохранение данных** - автоматическое сохранение в JSON файлы

### Расширенные функции
- 💸 **Переводы между пользователями** - отправка денег другим пользователям
- 📊 **Фильтрация по категориям** - анализ по выбранным категориям
- 📤 **Экспорт данных** - выгрузка в CSV и JSON форматы
- 🔔 **Умные уведомления** - предупреждения при 80% использования бюджета
- 🎨 **Красивый CLI интерфейс** - удобный пользовательский интерфейс

## 🏗️ Архитектура

Проект построен на принципах **Clean Architecture** с четким разделением слоев:

```
┌─────────────────────────────────────────────┐
│              CLI Layer                      │
│    (Пользовательский интерфейс)            │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│          Service Layer                      │
│  (Бизнес-логика и сервисы)                 │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│          Domain Layer                       │
│  (Доменные модели и интерфейсы)            │
└─────────────────────────────────────────────┘
                    ↓
┌─────────────────────────────────────────────┐
│      Infrastructure Layer                   │
│  (Хранение данных, файлы, уведомления)     │
└─────────────────────────────────────────────┘
```

### Основные компоненты:

- **Domain** (`core/domain/`) - доменные модели (User, Wallet, Transaction, Budget)
- **Services** (`core/service/`) - бизнес-логика (AuthService, TransactionService, BudgetService)
- **Repositories** (`core/repository/`) - интерфейсы для работы с данными
- **Infrastructure** (`infrastructure/`) - реализация хранения и уведомлений
- **CLI** (`cli/`) - консольный интерфейс

## 📦 Требования

- **Java**: 17 или выше
- **Maven**: 3.8 или выше
- **ОС**: Windows, macOS, Linux

## 🚀 Установка и запуск

### 1. Клонирование репозитория

```bash
git clone https://github.com/YOUR_USERNAME/finances.git
cd finances
```

### 2. Сборка проекта

```bash
mvn clean package
```

### 3. Запуск приложения

#### Вариант A: Через скрипт (рекомендуется) 🚀
```bash
./run.sh
```

Скрипт автоматически:
- Проверит версию Java
- Соберет проект
- Создаст JAR файл
- Запустит приложение

#### Вариант B: Через Maven
```bash
mvn exec:java -Dexec.mainClass="com.finances.Main"
```

#### Вариант C: Через JAR файл
```bash
mvn clean package
java -jar target/finance-manager.jar
```

## 📖 Использование

### Первый запуск

1. Запустите приложение
2. Выберите "Зарегистрироваться"
3. Введите логин и пароль
4. После регистрации войдите в систему

### Основные операции

#### Добавление дохода
```
Главное меню → 1. Добавить доход
Категория: Зарплата
Сумма: 50000
Описание: Месячная зарплата
```

#### Добавление расхода
```
Главное меню → 2. Добавить расход
Категория: Еда
Сумма: 5000
Описание: Продукты
```

#### Установка бюджета
```
Главное меню → 3. Установить бюджет
Категория: Еда
Лимит бюджета: 10000
```

#### Просмотр статистики
```
Главное меню → 4. Показать статистику
```

#### Перевод другому пользователю
```
Главное меню → 6. Перевод другому пользователю
Логин получателя: bob
Сумма перевода: 1000
Описание: Подарок
```

## 💡 Примеры команд

### Пример полного сценария использования

```
=== РЕГИСТРАЦИЯ ===
Логин: alice
Пароль: password123

=== ДОБАВЛЕНИЕ ДОХОДОВ ===
Зарплата: 20000
Зарплата: 40000  (премия)
Бонус: 3000

=== ДОБАВЛЕНИЕ РАСХОДОВ ===
Еда: 300
Еда: 500
Развлечения: 3000
Коммунальные услуги: 3000
Такси: 1500

=== УСТАНОВКА БЮДЖЕТОВ ===
Еда: 4000
Развлечения: 3000
Коммунальные услуги: 2500

=== РЕЗУЛЬТАТ СТАТИСТИКИ ===
Общий доход: 63,000.0
Доходы по категориям:
  Зарплата: 60,000.0
  Бонус: 3,000.0

Общие расходы: 8,300.0
Расходы по категориям:
  Еда: 800.0
  Развлечения: 3,000.0
  Коммунальные услуги: 3,000.0
  Такси: 1,500.0

Баланс: 54,700.0

Бюджеты по категориям:
  ✓ Еда: Лимит=4000.0, Потрачено=800.0, Осталось=3200.0 (20%)
  ✓ Развлечения: Лимит=3000.0, Потрачено=3000.0, Осталось=0.0 (100%)
  ✗ Коммунальные услуги: Лимит=2500.0, Потрачено=3000.0, Осталось=-500.0 (120%)

🚨 ПРЕВЫШЕНИЕ БЮДЖЕТА: Категория 'Коммунальные услуги' превышена на 500.00 (120%)
```

### Команды помощи

Введите `9` в главном меню для просмотра подробной справки по всем командам.

## 🧪 Тестирование

Проект включает комплексное тестирование:

### Запуск тестов через скрипт (рекомендуется) 🚀

```bash
# Просто запустить тесты
./test.sh

# Запустить тесты и показать покрытие
./test.sh -c

# Запустить все проверки (тесты, покрытие, стиль кода)
./test.sh -a

# Только проверки стиля и форматирования
./test.sh -s -f

# Показать все опции
./test.sh -h
```

### Запуск тестов через Maven

```bash
# Все тесты
mvn test

# С покрытием
mvn clean test jacoco:report
```

Отчет о покрытии будет доступен в: `target/site/jacoco/index.html`

### Типы тестов

- **Unit-тесты** (60+ тестов):
  - Тесты доменных моделей
  - Тесты сервисов
  - Тесты репозиториев

- **Интеграционные тесты**:
  - Полный цикл работы с системой
  - Тесты переводов между пользователями
  - Тесты сохранения/загрузки данных

### Покрытие кода

Текущее покрытие: **>50%**

Для проверки покрытия:
```bash
mvn jacoco:check
```

## 📂 Структура проекта

```
finances/
├── src/
│   ├── main/
│   │   └── java/
│   │       └── com/
│   │           └── finances/
│   │               ├── Main.java
│   │               ├── core/
│   │               │   ├── domain/
│   │               │   │   ├── User.java
│   │               │   │   ├── Wallet.java
│   │               │   │   ├── Transaction.java
│   │               │   │   ├── TransactionType.java
│   │               │   │   └── Budget.java
│   │               │   ├── service/
│   │               │   │   ├── AuthService.java
│   │               │   │   ├── TransactionService.java
│   │               │   │   └── BudgetService.java
│   │               │   └── repository/
│   │               │       ├── UserRepository.java
│   │               │       └── WalletRepository.java
│   │               ├── infrastructure/
│   │               │   ├── persistence/
│   │               │   │   ├── InMemoryUserRepository.java
│   │               │   │   ├── InMemoryWalletRepository.java
│   │               │   │   └── FileStorage.java
│   │               │   └── notification/
│   │               │       └── NotificationService.java
│   │               └── cli/
│   │                   └── CLI.java
│   └── test/
│       └── java/
│           └── com/
│               └── finances/
│                   ├── core/
│                   │   ├── domain/
│                   │   │   ├── TransactionTest.java
│                   │   │   ├── WalletTest.java
│                   │   │   ├── UserTest.java
│                   │   │   └── BudgetTest.java
│                   │   └── service/
│                   │       ├── AuthServiceTest.java
│                   │       ├── TransactionServiceTest.java
│                   │       └── BudgetServiceTest.java
│                   ├── infrastructure/
│                   │   ├── notification/
│                   │   │   └── NotificationServiceTest.java
│                   │   └── persistence/
│                   │       └── FileStorageTest.java
│                   └── integration/
│                       └── FinanceSystemIntegrationTest.java
├── .github/
│   └── workflows/
│       └── ci.yml
├── pom.xml
├── checkstyle.xml
├── .gitignore
└── README.md
```

## 🛠️ Технологии

- **Java 17** - основной язык программирования
- **Maven** - система сборки и управления зависимостями
- **JUnit 5** - фреймворк для тестирования
- **Mockito** - библиотека для mock-объектов в тестах
- **Gson** - библиотека для работы с JSON
- **JaCoCo** - инструмент для измерения покрытия кода
- **Checkstyle** - проверка стиля кода
- **Spotless** - автоматическое форматирование кода
- **GitHub Actions** - CI/CD pipeline

## 🔧 Дополнительные команды

### Быстрые команды через скрипты

```bash
# Запуск приложения
./run.sh

# Тесты с покрытием
./test.sh -c

# Все проверки качества
./test.sh -a
```

### Команды Maven

```bash
# Проверка стиля кода
mvn checkstyle:check

# Форматирование кода
mvn spotless:apply

# Создание документации
mvn javadoc:javadoc

# Полная сборка
mvn clean install
```

## 📊 Форматы экспорта данных

### CSV формат
```csv
Type,Category,Amount,Date,Description
INCOME,Зарплата,50000.00,2024-01-15,Месячная зарплата
EXPENSE,Еда,5000.00,2024-01-16,Продукты
```

### JSON формат
```json
{
  "userId": "alice",
  "balance": 45000.0,
  "totalIncome": 50000.0,
  "totalExpense": 5000.0,
  "transactions": [
    {
      "id": "uuid",
      "type": "INCOME",
      "category": "Зарплата",
      "amount": 50000.0,
      "timestamp": "2024-01-15T10:00:00",
      "description": "Месячная зарплата"
    }
  ],
  "budgets": {
    "Еда": 10000.0
  }
}
```

## 🔐 Безопасность

- Пароли хэшируются с использованием SHA-256
- Данные хранятся локально в защищенных файлах
- Каждый пользователь имеет изолированный кошелек

## 📝 Хранение данных

Данные каждого пользователя сохраняются в:
```
wallets/
  └── username.wallet
```

Файлы создаются автоматически при первом входе и обновляются при выходе.

## 🤝 Вклад в проект

Этот проект был разработан как учебное задание для курса ООП в магистратуре.

## 📄 Лицензия

MIT License - см. файл [LICENSE](LICENSE) для деталей.

## 👨‍💻 Автор

Студент магистратуры, курс ООП

---

**Примечание**: Это учебный проект, демонстрирующий применение принципов ООП, чистой архитектуры и best practices разработки на Java.

